base: ../globals.yaml

services:
  demo:
  wms:
    md:
      title: LiDAR from DOGAMI (old version)
      abstract: Proxy of DOGAMI LiDAR services

layers:
  - name: dogamihh
    title:  Highest Hit Hillshade
    md:
      attribution:
        title: Oregon Department of Geology and Mineral Industries
        url: https://dogami.oregon.gov
    layers:
      - name: highesthit
        title: Highest Hit Hillshade
        sources: [hh_cache]

  - name: dogamibe
    title: Bare Earth Hillshade
    md:
      attribution:
        title: Oregon Department of Geology and Mineral Industries
        url: https://dogami.oregon.gov
    layers:
      - name: bareearth
        title: Bare Earth Hillshade
        sources: [be_cache]

caches:
  be_cache:
    grids: [county]
    sources: [be_source]
    format: image/jpeg
    request_format: image/jpeg
    cache: 
      type: couchdb
      url: http://couchdb:5984
      db_name: dogamibe
      tile_metadata: 
        tile_col: '{{x}}'
        tile_row: '{{y}}'
        tile_level: '{{z}}'
        created_ts: '{{timestamp}}'
        created: '{{utc_iso}}'
        center: '{{wgs_tile_centroid}}'
           
  hh_cache:
    grids: [county]
    sources: [hh_source]
    format: image/jpeg
    request_format: image/jpeg
    cache: 
      type: couchdb
      url: http://couchdb:5984
      db_name: dogamihh
      tile_metadata: 
        tile_col: '{{x}}'
        tile_row: '{{y}}'
        tile_level: '{{z}}'
        created_ts: '{{timestamp}}'
        created: '{{utc_iso}}'
        center: '{{wgs_tile_centroid}}'
           
sources:
  be_source:
    type: arcgis
    req:
      url: https://gis.dogami.oregon.gov/arcgis/rest/services/Public/BareEarthHS/ImageServer
      transparent: true

  hh_source:
    type: arcgis
    req:
      url: https://gis.dogami.oregon.gov/arcgis/rest/services/Public/HighestHitHS2/ImageServer
      transparent: true

grids:
  county:
    base: GLOBAL_WEBMERCATOR
    bbox: [-124.1,45.77,-123.35,46.3] # Clatsop county
    bbox_srs: EPSG:4326

